import{v as e,x as a,y as s,z as l,o,a as t,w as r,g as u,d as i,f as n,A as m,B as d,C as c,D as p,r as f,E as g}from"./index-3809deb0.js";import{_,a as y,b as h,c as V}from"./logo.18823c2f.js";import{r as x}from"./uni-app.es.b1452fe7.js";import"./mqtt.d6b2f96e.js";import{_ as k}from"./_plugin-vue_export-helper.1b428a4d.js";const v=k({__name:"login",setup(k){const v=a(),w=s(null),j=l({email:"",password:""}),b={email:{rules:[{required:!0,errorMessage:"必填项"},{format:"email",errorMessage:"邮件格式错误"}]}},z=()=>{w.value.validate().then((a=>{var s,l;(s="api/mobile/elogin",l=j,e({url:s,method:"POST",data:l})).then((e=>{if(console.log(e),e.success){const a=e.data.userinfo;v.setToken(a.token),v.fillUser(a),m({key:"isLogin",data:"1",success:function(){console.log("setStorage success")}}),d({url:"/pages/my/my"})}})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))};function C(){c({url:"/pages/index/register",success(e){console.log(e)},fail(e){console.log(e)}})}return(e,a)=>{const s=p,l=u,m=x(f("uni-easyinput"),y),d=x(f("uni-forms-item"),h),c=g,k=x(f("uni-forms"),V);return o(),t(l,null,{default:r((()=>[i(l,{class:"logo"},{default:r((()=>[i(s,{src:_})])),_:1}),i(k,{class:"myForm",ref_key:"myForm",ref:w,modelValue:j,rules:b},{default:r((()=>[i(d,{name:"email"},{default:r((()=>[i(m,{class:"input",modelValue:j.email,"onUpdate:modelValue":a[0]||(a[0]=e=>j.email=e),placeholder:"请输入电子邮箱","suffix-icon":"email"},null,8,["modelValue"])])),_:1}),i(d,{name:"password"},{default:r((()=>[i(m,{class:"input",type:"password",modelValue:j.password,"onUpdate:modelValue":a[1]||(a[1]=e=>j.password=e),placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),i(c,{type:"primary",onClick:z},{default:r((()=>[n("用户登录")])),_:1}),i(l,{class:"logo-extra"},{default:r((()=>[i(c,{type:"default",size:"mini"},{default:r((()=>[n("忘记密码")])),_:1}),i(c,{type:"default",size:"mini",onClick:C},{default:r((()=>[n("用户注册")])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}}},[["__scopeId","data-v-2a561dce"]]);export{v as default};
